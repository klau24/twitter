Yurgh. My code smells really badly today. Definitely need less shoehorns and more time 
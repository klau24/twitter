Was working late tonight recreating some lost code.  I came up with good improvements, so I feel both stupid and clever at the same time. 
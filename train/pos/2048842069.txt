Code refactoring in progress... Yay 
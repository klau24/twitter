wow this is complex! No tests... poor naming... dead code 